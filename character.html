<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8"/>
   <title>Golden Son</title>
   <!--convert these to prod versions later-->
   <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
   <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
   <!--TODO: convert babel to js instead of using a large CDN-->
   <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

   <script src="database.js"></script>
   <script src="prototype.js"></script>
   <script src="main.js"></script>
   <script>
      var character = {
         name: '',
         adept: 'none',
         combatType: 'Warrior',
         background: 'Academic',
         activeClass: 'None',
         level: 1,
         stats: {
            base: {hp: 0, pp: 0, attack: 0, defense: 0, agility: 0, luck: 0},
            addend: {hp: 0, pp: 0, attack: 0, defense: 0, agility: 0, luck: 0},
            multiplier: {hp: 1, pp: 1, attack: 1, defense: 1, agility: 1, luck: 1},
            final: {hp: 0, pp: 0, attack: 0, defense: 0, agility: 0, luck: 0}
         },
         djinn: {counts: {earth: 0, fire: 0, wind: 0, ice: 0}, names: []},
         equipment: [],
         psynergy: []
      };
   </script>
   <style>
      body {
         padding-left: 10px;
         padding-bottom: 150px;
      }
   </style>
</head>
<body onload="updateAllFinalStats();">
<h2>General</h2>
<label>Name: <input type="text" id="name" value="" onchange="character.name = document.getElementById('name').value;"/></label><br/>
<label>Adept (Elemental Alignment):
   <select id="adept" onchange="updateAdept();">
      <option value="none">None</option>
      <option value="earth">Venus (Earth)</option>
      <option value="fire">Mars (Fire)</option>
      <option value="wind">Jupiter (Wind)</option>
      <option value="ice">Mercury (Ice)</option>
      <option value="sun">Sol (Sun)</option>
      <option value="moon">Luna (Moon)</option>
   </select>
</label><br/>
<label>Combat type:
   <select id="combatType" onchange="updateCombatType();">
      <option value="Warrior">Warrior</option>
      <option value="Mage">Mage</option>
      <option value="Rogue">Rogue</option>
   </select>
</label><br/>
<label for="backgroundSelect">Background:</label>
<div style="display:inline-block;" id="backgroundDiv"></div>
<script type="text/babel">
   function BackgroundOptions() {
      const options = database.backgrounds.names.map((name) =>
         <option key={name} value={name}>{name}</option>
      );
      return (
         <select id="backgroundSelect" onChange={updateBackground}>
            {options}
         </select>
      );
   }

   ReactDOM.render(
      <BackgroundOptions/>,
      document.getElementById('backgroundDiv')
   );
</script>
<br/>
<label>Level: <input type="number" id="level" value="1" min="1" onchange="updateLevel();"/></label><br/>
<h2>Base stats</h2>
<label>HP: <input type="number" id="hp" onChange="updateBaseStat('hp')" value="0" min="0"/></label><br/>
<label>PP: <input type="number" id="pp" onChange="updateBaseStat('pp')" value="0" min="0"/></label><br/>
<label>Attack: <input type="number" id="attack" onChange="updateBaseStat('attack')" value="0" min="0"/></label><br/>
<label>Defense: <input type="number" id="defense" onChange="updateBaseStat('defense')" value="0" min="0"/></label><br/>
<label>Agility: <input type="number" id="agility" onChange="updateBaseStat('agility')" value="0" min="0"/></label><br/>
<label>Luck: <input type="number" id="luck" onChange="updateBaseStat('luck')" value="0" min="0"/></label><br/>
<h2>Djinn</h2>
<div id="djinn"></div>
<script type="text/babel">
   function DjinnList(props) {
      const listItems = props.names.map((name) => {
         var djinn = database.djinn[name];
         return (<li key={'djinn-' + name} id={'djinn-' + name} data-name={name}>
            <a href="#" onClick={removeDjinn}>Remove</a>
            {' '}<b>{name}</b>{'. ' + djinn.description}
         </li>);
      });
      const options = database.djinn.names.filter((name) => !character.djinn.names.contains(name)).map((name) =>
         <option key={name}>{name}</option>
      );
      if (0 !== options.length) {
         listItems.push(<li key={'add-djinn'} id={'add-djinn'}>
            <DjinnDropDown element="earth" display="Venus (Earth)"/>
            {' '}
            <DjinnDropDown element="fire" display="Mars (Fire)"/>
            {' '}
            <DjinnDropDown element="wind" display="Jupiter (Wind)"/>
            {' '}
            <DjinnDropDown element="ice" display="Mercury (Ice)"/>
         </li>);
      }
      return (
         <ul>{listItems}</ul>
      );
   }

   function DjinnDropDown(props) {
      const options = database.djinn.names
         .filter((name) => database.djinn[name].element === props.element)
         .filter((name) => !character.djinn.names.contains(name))
         .map((name) =>
            <option key={name}>{name}</option>
         );
      if (0 !== options.length) {
         return (<select onChange={addDjinn}>
            <option>Add {props.display} Djinn...</option>
            {options}
         </select>);
      }
      return '';
   }

   function renderDjinn() {
      ReactDOM.render(
         <DjinnList names={character.djinn.names}/>,
         document.getElementById('djinn')
      );
   }
</script>
<h2>Equipment</h2>
<div id="equipment"></div>
<script type="text/babel">
   function EquipmentList(props) {
      const listItems = props.names.map((name) => {
         var equipment = database.equipment[name];
         return (<li key={'equipment-' + name} id={'equipment-' + name} data-name={name}>
            <a href="#" onClick={removeEquipment}>Remove</a>
            {' '}<b>{name}</b>{'. ' + equipment.description}
         </li>);
      });
      const options = database.equipment.names.filter((name) => !character.equipment.contains(name)).map((name) =>
         <option key={name}>{name}</option>
      );
      if (0 !== options.length) {
         listItems.push(<li key={'add-equipment'} id={'add-equipment'}>
            <select onChange={addEquipment}>
               <option>Add Equipment...</option>
               {options}
            </select>
         </li>);
      }
      return (
         <ul>{listItems}</ul>
      );
   }

   function renderEquipment() {
      ReactDOM.render(
         <EquipmentList names={character.equipment}/>,
         document.getElementById('equipment')
      );
   }
</script>
<h2>Final stats</h2>
Class: <span id="class"></span><br/>
HP: <span id="hp-final"></span><br/>
PP: <span id="pp-final"></span><br/>
Attack: <span id="attack-final"></span><br/>
Defense: <span id="defense-final"></span><br/>
Agility: <span id="agility-final"></span><br/>
Luck: <span id="luck-final"></span><br/>
<h2>Psynergy</h2>
<div id="psynergy"></div>
<script type="text/babel">
   function PsynergyList(props) {
      const listItems = props.names.map((name) => {
         var psynergy = database.psynergy[name];
         return (<li key={'psynergy-' + name} id={'psynergy-' + name} data-name={name}>
            <b>{name}</b>{'. ' + psynergy.description}
         </li>);
      });
      if (0 === listItems.length) return 'None';
      return (
         <ul>{listItems}</ul>
      );
   }

   function renderPsynergy() {
      ReactDOM.render(
         <PsynergyList names={character.psynergy}/>,
         document.getElementById('psynergy')
      );
   }
</script>
<br/><br/>
<span onClick="saveToFile();"><a href="javascript:alert('This link changes to data as you click it');" download=""
                                 id="save-to-file-link">Save to File</a></span>
<input type="button" value="Save To Text Area" onClick="saveToTextArea();" id="save-text-button"/>
<br/>
<input type="file" id="file-chooser" accept=".js,.json"/><br/>
<input type="button" value="Load from File" onClick="loadFile();"/>
<input type="button" value="Load from Text Area" onClick="loadFromTextArea();" id="load-text-button"/><br/>
<br/>
<textarea id="code-box" rows="10" cols="50"></textarea>
<!----
<script src="../Miscellaneous/src/main/javascript/testRunner.js"></script>
<script src="tests/database.js"></script>
<h2>Admin Powers</h2>
<br />
<form action="javascript:void(0);">
<input type="text" value="TestRunner.testAll();" id="command-text" />
<input type="submit" value="Execute" onClick="eval(document.getElementById('command-text').value);" /><br />
</form>
<script>
function convertToJsFile()
{
   //TODO: have a thing that prints out the number of classes possible for a given adept and combat type
}
</script>
<a href="javascript:convertToJsFile();">Print class counts</a><br />
<a href="javascript:TestRunner.testAll();">Test All</a><br />
<a href="javascript:eval(document.getElementById('code-box').value);">Eval Code Box</a> (above)<br />
testResults:<br />
<textarea id="testResults" rows="10" cols="50"></textarea>
<!---->
</body>
</html>
<!--Random notes:
Background: Guard
A. Character sheets that allow modifications and preferably let you pick adeptness, background, skills, and psyenergy.
B. Djinn which are equippable
C. Equipment same as above
D. Classes that are switched between based on djinn, background, and adeptness
Mostly I want equip logic. If you standby a djinn your stats and class changes

Golden sun base stats: https://docs.google.com/spreadsheets/d/1uYmx3L2Xn2MEsw-mm_WfiT-_W-UulH4iT0TJMUxNdsI/edit?usp=sharing
Golden Sun Reloaded Class Chart: https://docs.google.com/spreadsheets/d/1W9VJcbmV5l6wGSiDO4oM6IV566i7XvVFQs_5WT0ajN8/edit#gid=1049218258
http://www.goldensun-syndicate.net/
https://goldensun.fandom.com/wiki/Djinn

TODO: Djinn States: Set, Standby, Recovery
- Set: gives you stats and class. can be "unleashed" which uses their ability which converts to Standby
- Standby: can be summoned (big attack) which converts to Recovery
- Recovery: does nothing for a bit then becomes Set

https://raw.githubusercontent.com/reactjs/reactjs.org/master/static/html/single-file-example.html
not sure how much state can/should be managed by react
-->
